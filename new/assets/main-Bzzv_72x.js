import{m as G,t as oe,h as z,i as ke,r as Le,f as be,a as $e,b as Ee,g as Me,c as O,d as se,e as F,j as X,k as xe,l as Z}from"./recentSearch-CchAC9s9.js";const Ce=[{id:"notice-2026-02-01",title:"2월 1일 설 연휴 운행 안내",body:"해당일은 휴일 시간표로 운행됩니다. 출발 전 꼭 시간표를 확인해 주세요.",startDate:"2026-01-28",endDate:"2026-02-02",tag:"휴일"},{id:"notice-2026-02-25",title:"2월 25일 특별휴일 운행",body:"특별 휴일 시간표가 적용됩니다.",startDate:"2026-02-24",endDate:"2026-02-26",tag:"공지"}],Ie=[{id:"wolpyeong",name:"월평-본교-시내 순환셔틀",stops:[{routeId:"wolpyeong",stopId:"stop-1"}]},{id:"wolpyeong-early",name:"월평-유성온천역-본교 (얼리월평 셔틀)",stops:[{routeId:"wolpyeong-early",stopId:"stop-1"}]},{id:"campus-loop",name:"본교-문지-화암 왕복셔틀",stops:[{routeId:"campus-loop",stopId:"stop-2"}]},{id:"olev",name:"OLEV 교내셔틀",stops:[{routeId:"olev",stopId:"stop-1"}]}],De={destinations:Ie};function R(e){return[e.name,e.subtitle||"",...e.tags||[]].join(" ")}function Te(e,t){return e.map(t)}function _e({rawQuery:e,effectiveQuery:t,filtered:n,isComposing:o}){const a=(e||"").trim().toLowerCase();return a?o?n.some(r=>{const c=typeof r=="string"?r:R(r);return G(c,a)})?a:t:a:t}const ae="kaist-bus-favorites",re="kaist-bus-theme",D="kaist-bus-night-sky",T="kaist-bus-night-sky-meta",ee="v2",Re=24*60*60*1e3,Fe=1/7,$="kaist-bus-card-glow";let S=null;const Ne="campus-loop",Ae=12,Q=4*60,ie=[{id:"main",label:"본교",match:/본교/},{id:"munji",label:"문지",match:/문지/},{id:"hwaam",label:"화암",match:/화암/}];function He(e){const t=new Map;return e.forEach(n=>{if(!t.has(n.id)){t.set(n.id,{...n,stops:n.stops.map(s=>{var r,c;return{...s,times:{weekday:[...((r=s.times)==null?void 0:r.weekday)||[]],weekend:[...((c=s.times)==null?void 0:c.weekend)||[]]}}})});return}const o=t.get(n.id);!o.note&&n.note&&(o.note=n.note);const a=new Map(o.stops.map(s=>[s.name,s]));n.stops.forEach(s=>{var c,d;const r=a.get(s.name);if(!r){const m={...s,times:{weekday:[...((c=s.times)==null?void 0:c.weekday)||[]],weekend:[...((d=s.times)==null?void 0:d.weekend)||[]]}};o.stops.push(m),a.set(s.name,m);return}["weekday","weekend"].forEach(m=>{var g,p;const i=((g=r.times)==null?void 0:g[m])||[],u=((p=s.times)==null?void 0:p[m])||[];if(!i.length&&u.length){r.times[m]=[...u];return}u.forEach(f=>{i.includes(f)||i.push(f)})})})}),Array.from(t.values())}const C=He(Le.routes);function ce(e,t){const n=e.stops.filter(o=>{var a;return(((a=o.times)==null?void 0:a[t])||[]).length});return n.length?n:e.stops}function le(e,t,n){const o=e.stops.filter(s=>s.id===t);return o.length?o.find(s=>{var r;return(((r=s.times)==null?void 0:r[n])||[]).length})||o[0]:null}function je(e){const[t,n]=e.split(":").map(Number);if(Number.isNaN(t)||Number.isNaN(n))return 0;let o=t*60+n;return t<4&&(o+=1440),o}function de(e){return!e||e.length===0?null:Math.max(...e.map(je))}function Be(e,t){if(!e)return null;const n=e.stops.flatMap(o=>{var a;return((a=o.times)==null?void 0:a[t])||[]});return de(n)}function N(e,t,n){var u;const o=H(e),a=new Date(e);a.setDate(e.getDate()-1);const s=H(a);if(o===s)return o;const r=e.getHours()*60+e.getMinutes();if(r>=Q)return o;const c=n?Be(n,s):de(((u=t==null?void 0:t.times)==null?void 0:u[s])||[]),d=c!=null&&c>=r+1440,m=g=>{var p;return(((p=t==null?void 0:t.times)==null?void 0:p[g])||[]).length>0};let i=d?s:o;return i===s&&!m(s)&&m(o)&&(i=o),i===o&&!m(o)&&m(s)&&d&&(i=s),i}const l={now:new Date,serviceDay:"weekday",holidayLabel:"",selectedRouteId:"",selectedStopId:"",selectedDestinationId:"",routeSearch:"",routeSearchBase:"",routeSearchComposing:!1,routeSearchStable:"",routeSearchLastHtml:"",routeSearchLastKeys:"",routeSearchLastHighlight:"",routeSearchActive:!1,glowLocked:!1};function M(){try{const e=localStorage.getItem(ae);return e?JSON.parse(e):[]}catch{return[]}}function x(e){return(e==null?void 0:e.id)===Ne}function A(e){var t;return((t=ie.find(n=>n.id===e))==null?void 0:t.label)||e}function K(e){const t=ie.find(n=>n.match.test(e));return t?t.id:null}function qe(e,t){const n=K(e[t].name);for(let o=t+1;o<e.length;o+=1){const a=K(e[o].name);if(a&&a!==n)return a}return null}function ue(e,t,n){const o=e.stops||[],a=o.map((c,d)=>({stop:c,index:d,campus:K(c.name)})).filter(c=>c.campus===t);if(!a.length)return o[0];const s=a.filter(c=>/출발/.test(c.stop.name)),r=s.length?s:a;if(n){const c=r.find(d=>qe(o,d.index)===n);if(c)return c.stop}return r[0].stop}function me(e,t,n,o,a){return!x(e)||t!=="weekend"||o!=="main"||a!=="hwaam"?n:n.filter(s=>s.trim()!=="11:30")}function W(e){localStorage.setItem(ae,JSON.stringify(e))}function V(e){var n;const t=oe(e);return z.forcedWeekends.includes(t)?{day:"weekend",label:((n=z.labels)==null?void 0:n[t])||"휴일"}:ke(e)?{day:"weekend",label:"주말"}:{day:"weekday",label:"평일"}}function H(e){return V(e).day}function Oe(){try{return localStorage.getItem(re)}catch{return null}}function Pe(e){try{localStorage.setItem(re,e)}catch{}}function J(e){const t=Oe();let n=!0;if(t==="dark")n=!1;else if(t==="light")n=!0;else{const a=e.getHours();n=a>=6&&a<18}document.body.classList.toggle("theme-night",!n),document.documentElement.classList.toggle("theme-night",!n);const o=document.querySelector('meta[name="theme-color"]');o&&o.setAttribute("content",n?"#e9ecff":"#05070f"),n?(document.documentElement.style.removeProperty("--night-sky"),document.documentElement.style.removeProperty("--app-bg")):Ge()}function Ge(){!S&&window.__nightSkyCss&&(S=window.__nightSkyCss);let e=null;try{e=JSON.parse(localStorage.getItem(T)||sessionStorage.getItem(T)||"null")}catch{e=null}const t=Date.now(),n=!e||e.version!==ee||!e.createdAt||t-e.createdAt>Re;if(!S&&!n)try{S=localStorage.getItem(D)||sessionStorage.getItem(D)}catch{S=null}if(!S||n){S=Ke();try{const o=JSON.stringify({version:ee,createdAt:t});localStorage.setItem(D,S),localStorage.setItem(T,o),sessionStorage.setItem(D,S),sessionStorage.setItem(T,o)}catch{}}window.__nightSkyCss=S,document.documentElement.style.setProperty("--night-sky",S),document.documentElement.style.setProperty("--app-bg",S)}function Ke(){const e=[],n=typeof window<"u"?window.innerWidth:1200,o=typeof window<"u"?window.innerHeight:800;for(let a=0;a<28;a+=1){const s=Math.floor(Math.random()*n),r=Math.floor(Math.random()*o),c=(Math.random()*1.8+.6).toFixed(2),d=(Math.random()*.5+.35).toFixed(2),i=Math.random()<.25?`rgba(255, 238, 180, ${d})`:`rgba(255, 255, 255, ${d})`;e.push(`radial-gradient(circle at ${s}px ${r}px, ${i} 0 ${c}px, transparent ${(Number(c)+1.6).toFixed(2)}px)`)}if(Math.random()<Fe){const a=Math.floor(Math.random()*n),s=Math.floor(Math.random()*(o*.6));e.push(`radial-gradient(circle at ${a}px ${s}px, rgba(255, 244, 190, 0.6) 0 6px, transparent 12px)`)}return e.push("linear-gradient(180deg, #05070f 0%, #0b1026 55%, #141b3f 100%)"),e.join(", ")}function pe(){const e=()=>Math.random()<.7?Math.random()<.5?-15+Math.random()*20:95+Math.random()*20:15+Math.random()*70,t=(a,s)=>{const r=Math.round(e()),c=Math.round(e()),d=Math.floor(420+Math.random()*420),m=Math.floor(320+Math.random()*360),i=(s+Math.random()*.06).toFixed(2);return`radial-gradient(${d}px ${m}px at ${r}% ${c}%, rgba(${a}, ${i}), transparent 72%)`},n=["246, 226, 138","255, 181, 201","171, 228, 255","160, 255, 224","198, 176, 255","255, 214, 165"],o=[];for(let a=0;a<10;a+=1){const s=n[a%n.length];o.push(t(s,.045))}return o}function fe(){if(l.routeSearchActive||!document.body.classList.contains("theme-night"))return;const e=document.querySelectorAll(".hero-card, .next-card, .notice-card, .time-table");let t={};try{t=JSON.parse(sessionStorage.getItem($)||"{}")}catch{t={}}const n=r=>r.classList.contains("hero-card")?"hero":r.classList.contains("next-card")?"next":r.classList.contains("notice-card")?"notice":r.classList.contains("route-card")?"route":r.classList.contains("time-table")?"table":"card",o=location.pathname.replace(/\W+/g,"")||"index",a={},s=!l.glowLocked;for(const r of e){const c=n(r),d=a[c]??0;a[c]=d+1;const m=r.dataset.glowKey,i=`${o}:${c}:${m||d}`;if(!t[i]){if(!s)continue;t[i]=pe()}const[u,g,p]=t[i];r.style.setProperty("--card-glow-1",u),r.style.setProperty("--card-glow-2",g),r.style.setProperty("--card-glow-3",p)}try{sessionStorage.setItem($,JSON.stringify(t))}catch{}s&&(l.glowLocked=!0)}function he(){document.body.classList.contains("theme-night")&&fe()}function P(){if(!document.body.classList.contains("theme-night"))return;const e=document.querySelector("#routeList");if(!e)return;const t=e.querySelectorAll(".route-card");if(!t.length)return;let n={};try{n=JSON.parse(sessionStorage.getItem($)||"{}")}catch{n={}}t.forEach(o=>{const a=`route:${o.dataset.glowKey||""}`;if(!n[a])return;const[s,r,c]=n[a];o.style.setProperty("--card-glow-1",s),o.style.setProperty("--card-glow-2",r),o.style.setProperty("--card-glow-3",c)});try{sessionStorage.setItem($,JSON.stringify(n))}catch{}}function ge(e){if(!document.body.classList.contains("theme-night"))return;let t={};try{t=JSON.parse(sessionStorage.getItem($)||"{}")}catch{t={}}e.forEach(n=>{const o=`route:${n.id}`;t[o]||(t[o]=pe())});try{sessionStorage.setItem($,JSON.stringify(t))}catch{}}function Y(e){const t=["olev","campus-loop","wolpyeong","wolpyeong-early"];return C.filter(n=>n.stops.some(o=>{var a,s;return(s=(a=o.times)==null?void 0:a[e])==null?void 0:s.length})).slice().sort((n,o)=>{const a=t.indexOf(n.id),s=t.indexOf(o.id),r=a===-1?Number.MAX_SAFE_INTEGER:a,c=s===-1?Number.MAX_SAFE_INTEGER:s;return r!==c?r-c:n.name.localeCompare(o.name)})}function L(){return["olev","campus-loop","wolpyeong","wolpyeong-early"].map(t=>C.find(n=>n.id===t)).filter(Boolean)}function U({routeId:e,stopId:t,campusFrom:n,campusTo:o}){const a=new URLSearchParams;e&&a.set("route",e),t&&a.set("stop",t),n&&a.set("from",n),o&&a.set("to",o);const s=a.toString();return s?`./route.html?${s}`:"./route.html"}function We(e){return e.find(t=>t.stops.some(n=>n.default))||e[0]}function te(){const e=document.querySelectorAll("[data-clock]"),t=document.querySelectorAll("[data-date]"),n=document.querySelectorAll("[data-weekday]"),o=document.querySelectorAll("[data-clock-card]"),a=document.querySelectorAll("[data-date-card]"),s=document.querySelectorAll("[data-weekday-card]"),r=document.querySelector("[data-weekday-badge]");if(!e.length||!t.length||!n.length)return;l.now=new Date;const c=be(l.now);e.forEach(f=>{f.textContent=c}),o.forEach(f=>{f.textContent=c});const m=$e(l.now).replace(/^\d{4}년\s*/,"");t.forEach(f=>{f.textContent=m}),a.forEach(f=>{f.textContent=m});const{day:i,label:u}=V(l.now);l.serviceDay=i,l.holidayLabel=u;const g=i==="weekday"?"평일":"휴일",p=Ee(l.now);n.forEach(f=>{f.textContent=`${p} (${g}) ·`}),s.forEach(f=>{f.textContent=p}),r&&(r.textContent=g),J(l.now)}function Je(){const e=document.querySelector("#noticeList");if(!e)return;const t=oe(l.now),n=Ce.filter(o=>(!o.startDate||o.startDate<=t)&&(!o.endDate||o.endDate>=t));e.innerHTML=n.length?n.map(o=>`
          <article class="notice-card">
            <div class="notice-tag">${o.tag||"공지"}</div>
            <h3>${o.title}</h3>
            <p>${o.body}</p>
            <span class="notice-date">${o.startDate||""}</span>
          </article>
        `).join(""):`
        <div class="notice-empty">
          현재 등록된 공지가 없습니다.
        </div>
      `}function b(e,t=null,n=null,o=!1){const a=document.querySelector("#routeList");if(!a)return;const s=t??l.routeSearch,r=n??l.routeSearchBase,c=!!o,d=c;let m=s.trim().toLowerCase(),i=m,u=m?e.filter(h=>G(R(h),m)):e,g=!1;if(d&&m&&u.length===0){const h=(r||l.routeSearchStable||"").trim().toLowerCase(),y=Te(e,R),v=Me(s,y,h);v&&(g=!0,i=v,u=e.filter(w=>G(R(w),i)))}const p=u.map(h=>h.id).join("|"),f=_e({rawQuery:s,effectiveQuery:i,filtered:u,isComposing:!!c});if(!c&&i&&(l.routeSearchStable=i),!c&&!i&&(l.routeSearchStable=""),g&&d&&l.routeSearchLastHtml&&l.routeSearchLastKeys===p&&l.routeSearchLastHighlight===f){P();return}if(!u.length){if(g&&d&&l.routeSearchLastHtml){a.innerHTML=l.routeSearchLastHtml,P();return}a.innerHTML=`
      <div class="notice-empty">검색 결과가 없습니다.</div>
    `;return}a.innerHTML=u.map(h=>{const y=f;return`
      <a class="route-card" data-glow-key="${h.id}" href="./route.html?route=${h.id}">
        <div>
          <h3>${O(h.name,y)}</h3>
          <p>${h.subtitle?O(h.subtitle,y):""}</p>
        </div>
        <div class="route-tags">
          ${(h.tags||[]).map(v=>`<span>${O(v,y)}</span>`).join("")}
        </div>
      </a>
    `}).join(""),l.routeSearchLastHtml=a.innerHTML,l.routeSearchLastKeys=p,l.routeSearchLastHighlight=f,P()}function j(e){const t=document.querySelector("#favoritesList");t&&(t.innerHTML="");const n=document.querySelector("#favoriteDockPanel"),o=document.querySelector("#favoriteDock"),a=document.querySelector("[data-favorite-tab]");if(!n)return;let s=M();if(!s.length){if(n.innerHTML=`
      <div class="favorite-dock__empty">
        즐겨찾기가 비어 있어요. 상단의 "즐겨찾기 추가" 버튼으로 등록해 주세요.
      </div>
    `,n.setAttribute("aria-live","polite"),o&&o.classList.add("is-empty"),a){const i=o==null?void 0:o.classList.contains("is-open");a.classList.toggle("is-active",!!i)}return}o&&o.classList.remove("is-empty"),n.style.display="";const r=l.now.getHours()*60+l.now.getMinutes(),c=[],d=[];if(s.forEach(i=>{var I;const u=C.find(B=>B.id===i.routeId);if(!u)return;const g=N(l.now,null,u);let p=le(u,i.stopId,g);if(x(u)&&i.campusFrom&&(p=ue({...u,stops:ce(u,g)},i.campusFrom,i.campusTo)),!p)return;c.push(i);const f=N(l.now,p,u),h=me(u,f,((I=p.times)==null?void 0:I[f])||[],i.campusFrom,i.campusTo),y=f!==H(l.now)&&r<Q?r+1440:r,v=h.length?se(h,y-2,2):[],w=h[h.length-1],E=x(u)&&i.campusFrom?`${A(i.campusFrom)} → ${A(i.campusTo)}`:p.direction&&p.direction!==u.name?`${F(u.id,p.name)} → ${p.direction}`:`${F(u.id,p.name)}`;d.push({item:i,route:u,stop:p,label:E,upcoming:v,lastTime:w})}),c.length!==s.length&&(s=c,W(c)),!d.length){n.innerHTML=`
      <div class="favorite-dock__empty">
        즐겨찾기가 비어 있어요. 상단의 "즐겨찾기 추가" 버튼으로 등록해 주세요.
      </div>
    `,o&&o.classList.add("is-empty"),a&&a.classList.remove("is-active");return}const m=d.map((i,u)=>{const g=u===0,p=u===d.length-1,f=[`data-jump-route="${i.route.id}"`,`data-jump-stop="${i.stop.id}"`,i.item.campusFrom?`data-jump-from="${i.item.campusFrom}"`:"",i.item.campusTo?`data-jump-to="${i.item.campusTo}"`:""].filter(Boolean).join(" ");return`
      <div class="favorite-dock__item" data-fav="${i.item.key}" ${f}>
        <div class="favorite-dock__title">
          <span>${i.route.name}</span>
          <span>${i.label}</span>
        </div>
        <div class="favorite-dock__row">
          <div class="favorite-dock__times">
            ${i.upcoming.length?i.upcoming.map(h=>`
                      <span>
                        ${h}
                        ${i.lastTime&&h===i.lastTime?'<em class="last-tag">막차</em>':""}
                      </span>
                    `).join(""):'<span class="favorite-dock__empty-text">미운행</span>'}
          </div>
          <div class="favorite-dock__actions">
            <button class="favorite-dock__move" type="button" data-move-favorite="up" data-key="${i.item.key}" ${g?"disabled":""} aria-label="위로">
              ↑
            </button>
            <button class="favorite-dock__move" type="button" data-move-favorite="down" data-key="${i.item.key}" ${p?"disabled":""} aria-label="아래로">
              ↓
            </button>
            <button class="favorite-dock__remove" type="button" data-remove-favorite="${i.item.key}">
              삭제
            </button>
          </div>
        </div>
      </div>
    `});n.innerHTML=m.join("")}function ne(e){const t=document.querySelector("#nextDepartures");if(!t)return;const n=M().slice(0,3);if(!n.length){t.innerHTML=`
      <div class="next-empty">
        즐겨찾기한 노선이 아직 없어요. 노선 상세에서 즐겨찾기를 추가하면
        여기에서 가까운 출발을 빠르게 확인할 수 있어요.
      </div>
    `,j();return}const o=l.now.getHours()*60+l.now.getMinutes(),a=n.map(s=>{var y;const r=C.find(v=>v.id===s.routeId);if(!r)return"";const c=N(l.now,null,r);let d=le(r,s.stopId,c);if(x(r)&&s.campusFrom&&(d=ue({...r,stops:ce(r,c)},s.campusFrom,s.campusTo)),!d)return"";const m=N(l.now,d,r),i=me(r,m,((y=d.times)==null?void 0:y[m])||[],s.campusFrom,s.campusTo);if(!i.length)return"";const u=m!==H(l.now)&&o<Q?o+1440:o,g=se(i,u-2,4),p=i[i.length-1],f=x(r)&&s.campusFrom?`${A(s.campusFrom)} → ${A(s.campusTo)}`:d.direction&&d.direction!==r.name?`${F(r.id,d.name)} → ${d.direction}`:`${F(r.id,d.name)}`,h=[`data-jump-route="${r.id}"`,`data-jump-stop="${d.id}"`,s.campusFrom?`data-jump-from="${s.campusFrom}"`:"",s.campusTo?`data-jump-to="${s.campusTo}"`:""].filter(Boolean).join(" ");return`
        <div class="next-card" data-glow-key="${s.key}" ${h} role="button" tabindex="0">
          <div class="next-header">
            <div>
              <h3>${r.name}</h3>
              <p>${f}</p>
            </div>
            <span class="next-badge">시간표 기준</span>
          </div>
          <div class="next-list">
            ${g.map(v=>`
                <div class="next-chip">
                  ${v}
                  ${p&&v===p?'<span class="last-tag">막차</span>':""}
                </div>
              `).join("")}
          </div>
          <p class="next-note">실시간 위치 아님 · 실제 운행과 차이 가능</p>
        </div>
      `}).filter(Boolean).join("");t.innerHTML=a||`
    <div class="next-empty">
      즐겨찾기한 노선이 아직 없어요. 노선 상세에서 즐겨찾기를 추가하면
      여기에서 가까운 출발을 빠르게 확인할 수 있어요.
    </div>
  `,t.onclick=s=>{const r=s.target.closest("[data-jump-route]");if(!r)return;const c=U({routeId:r.dataset.jumpRoute,stopId:r.dataset.jumpStop,campusFrom:r.dataset.jumpFrom,campusTo:r.dataset.jumpTo});window.location.href=c},t.onkeydown=s=>{if(s.key!=="Enter"&&s.key!==" ")return;const r=s.target.closest("[data-jump-route]");if(!r)return;s.preventDefault();const c=U({routeId:r.dataset.jumpRoute,stopId:r.dataset.jumpStop,campusFrom:r.dataset.jumpFrom,campusTo:r.dataset.jumpTo});window.location.href=c},j(),fe()}function Ye(){const e=document.querySelector("[data-theme-toggle]");e&&(e.addEventListener("click",()=>{const t=document.body.classList.contains("theme-night");Pe(t?"light":"dark"),J(new Date),l.glowLocked=!1,t||ge(L()),he()}),J(new Date))}function Ue(){const e=document.querySelector("#favoriteDock"),t=document.querySelector("[data-favorite-tab]"),n=document.querySelector("#favoriteDockPanel");if(!e||!t)return;let o=!1;const a=()=>{t.classList.toggle("is-active",e.classList.contains("is-open"))},s=()=>{e.classList.add("is-open"),a(),c()},r=()=>{o||(e.classList.remove("is-open"),a())};e.addEventListener("mouseenter",()=>s()),e.addEventListener("mouseleave",()=>r()),t.addEventListener("mouseenter",()=>s()),t.addEventListener("mouseleave",()=>r()),e.addEventListener("click",()=>{o=!o,o?(e.classList.add("is-open"),a()):(e.classList.remove("is-open"),a())}),t.addEventListener("click",()=>{o=!o,o?(e.classList.add("is-open"),a()):(e.classList.remove("is-open"),a())});const c=()=>{if(!window.matchMedia("(max-width: 640px)").matches||!e.classList.contains("is-open"))return;const m=t.getBoundingClientRect();e.style.top=`${Math.round(m.bottom+8)}px`};document.addEventListener("click",d=>{e.classList.contains("is-open")&&(e.contains(d.target)||t.contains(d.target)||(o=!1,e.classList.remove("is-open"),a()))}),n&&(n.addEventListener("click",d=>{d.stopPropagation();const m=d.target.closest("[data-move-favorite]");if(m){const p=m.dataset.key,f=m.dataset.moveFavorite;if(!p||!f)return;const h=M(),y=h.findIndex(E=>E.key===p),v=f==="up"?y-1:y+1;if(y<0||v<0||v>=h.length)return;const w=h.slice();[w[y],w[v]]=[w[v],w[y]],W(w),j(Y(l.serviceDay));return}const i=d.target.closest("[data-remove-favorite]");if(!i)return;const u=i.dataset.removeFavorite;if(!u)return;const g=M().filter(p=>p.key!==u);W(g),j(Y(l.serviceDay))}),n.addEventListener("click",d=>{if(d.target.closest("[data-remove-favorite]")||d.target.closest("[data-move-favorite]"))return;const u=d.target.closest("[data-jump-route]");if(!u)return;const g=U({routeId:u.dataset.jumpRoute,stopId:u.dataset.jumpStop,campusFrom:u.dataset.jumpFrom,campusTo:u.dataset.jumpTo});window.location.href=g})),a(),window.addEventListener("scroll",c,{passive:!0}),window.addEventListener("resize",c),t.addEventListener("click",c),e.addEventListener("mouseenter",c)}function _(){const e=document.querySelector("header.navbar"),t=e==null?void 0:e.querySelector(".brand"),n=e==null?void 0:e.querySelector(".primary-nav"),o=n==null?void 0:n.querySelector(".nav-links"),a=n==null?void 0:n.querySelector(".nav-actions");if(!e||!t||!n||(e.classList.contains("is-wrapped")&&e.classList.remove("is-wrapped"),!o||!a))return;const r=Array.from(o.children).some(k=>k.scrollHeight>k.clientHeight+2),c=Array.from(a.children).some(k=>k.scrollHeight>k.clientHeight+2),d=parseFloat(getComputedStyle(e).gap||"0")||0,m=parseFloat(getComputedStyle(n).gap||"0")||0,i=k=>{const q=Array.from(k.children);if(!q.length)return 0;const ve=parseFloat(getComputedStyle(k).gap||"0")||0;return q.reduce((Se,we)=>Se+we.getBoundingClientRect().width,0)+ve*(q.length-1)},u=i(o)+i(a)+m,g=e.clientWidth-t.getBoundingClientRect().width-d,p=o.getBoundingClientRect(),f=a.getBoundingClientRect(),h=n.getBoundingClientRect(),y=e.getBoundingClientRect(),v=t.getBoundingClientRect(),w=p.right>f.left-8,E=h.left<v.right+8,I=h.right>y.right-8,B=u>g-Ae,ye=r||c||w||E||I||B;e.classList.toggle("is-wrapped",ye)}function Qe(){var e;_(),window.addEventListener("resize",_),window.addEventListener("load",_),(e=document.fonts)!=null&&e.ready&&document.fonts.ready.then(_)}function Ve(){const e=document.querySelector("#routeSearch"),t=document.querySelector("#routeSearchRecent"),n=document.querySelector(".search-clear");if(!e)return;e.value=l.routeSearch;const o=()=>{n&&n.classList.toggle("is-visible",!!e.value)},a=()=>{if(!t)return;const s=xe("route");if(!s.length){t.innerHTML=`
        <div class="search-recent__label">최근 검색</div>
        <div class="search-recent__empty">-</div>
      `;return}t.innerHTML=`
      <div class="search-recent__label">최근 검색</div>
      <div class="search-recent__items">
        ${s.map(r=>`<button type="button" class="search-chip" data-recent="${Z(r)}">${Z(r)}</button>`).join("")}
      </div>
    `};a(),o(),e.addEventListener("compositionstart",()=>{l.routeSearchComposing=!0,l.routeSearchBase=l.routeSearch}),e.addEventListener("compositionend",()=>{l.routeSearchComposing=!1,l.routeSearch=e.value,b(L(),e.value,l.routeSearchBase,!1),o()}),e.addEventListener("compositionupdate",()=>{b(L(),e.value,l.routeSearchBase,!0)}),e.addEventListener("input",()=>{if(l.routeSearch=e.value,l.routeSearchComposing){b(L(),e.value,l.routeSearchBase,!0),o();return}b(L(),e.value,l.routeSearchBase,!1),o()}),e.addEventListener("focus",()=>{l.routeSearchActive=!0}),e.addEventListener("blur",()=>{l.routeSearchActive=!1}),e.addEventListener("keydown",s=>{s.key==="Enter"&&(X("route",e.value),a(),o())}),e.addEventListener("blur",()=>{X("route",e.value),a(),o()}),t&&t.addEventListener("click",s=>{const r=s.target.closest("[data-recent]");r&&(e.value=r.dataset.recent||"",l.routeSearch=e.value,b(L(),e.value,l.routeSearchBase,!1),o(),e.focus())}),n&&n.addEventListener("click",()=>{e.value="",l.routeSearch="",l.routeSearchBase="",b(L(),"","",!1),o(),e.focus()})}function ze(){var t;const e=(t=window.getSelection)==null?void 0:t.call(window);return e?!e.isCollapsed&&e.toString().trim().length>0:!1}function Xe(){const{day:e}=V(l.now);l.serviceDay=e;const t=Y(l.serviceDay);if(t.length===0)return;const n=M();if(n.length){l.selectedRouteId=n[0].routeId,l.selectedStopId=n[0].stopId;const a=C.find(c=>c.id===l.selectedRouteId),s=a==null?void 0:a.stops.find(c=>c.id===l.selectedStopId),r=De.destinations.find(c=>c.name===(s==null?void 0:s.direction));r&&(l.selectedDestinationId=r.id)}else l.selectedRouteId=We(t).id;te(),Je();const o=L();ge(o),b(o),ne(),he(),Ye(),Ue(),Ve(),Qe(),setInterval(()=>{te(),!l.routeSearchActive&&(ze()||ne())},1e3)}Xe();
